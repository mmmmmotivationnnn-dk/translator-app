<!DOCTYPE html>
<html lang="uk" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text Categories</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        :root { --card-hover-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.2); }
        body { display: flex; align-items: center; justify-content: center; min-height: 100vh; padding: 2rem; background-color: #1a1b26; }
        .container { max-width: 1000px; width: 100%; }
        .category-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-top: 2rem; }
        .category-card { display: block; text-decoration: none; color: #a9b1d6; background-color: #24283b; border: 1px solid #414868; border-radius: var(--pico-border-radius); padding: 2.5rem 2rem; text-align: center; transition: transform 0.2s ease-out, box-shadow 0.2s ease-out; }
        .category-card:hover { transform: translateY(-8px); box-shadow: var(--card-hover-shadow); }
        .category-card i { font-size: 3.5rem; margin-bottom: 1.5rem; color: #7aa2f7; transition: color 0.2s; }
        .category-card:hover i { color: #9eceff; }
        .category-card h2 { margin: 0; font-size: 1.5rem; font-weight: bold; color: #c0caf5; }

        /* Нові стилі для селектора моделей */
        .model-selector-card {
            background-color: #24283b;
            border: 1px solid #414868;
            padding: 1.5rem 2rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            text-align: center;
        }
        .model-selector-card label {
            font-size: 1.1rem;
            color: #c0caf5;
            margin-right: 1rem;
        }
        .model-selector-card select {
            min-width: 250px;
            border-color: #414868;
            background-color: #1f2335;
        }
        #save-confirmation {
            color: #9eceff;
            font-size: 0.9em;
            margin-top: 1rem;
            opacity: 0;
            transition: opacity 0.3s;
        }
    </style>
</head>
<body>
    <main class="container">
        <hgroup>
            <h1 style="text-align: center; color: #c0caf5;">Choose a Category</h1>
            <p style="text-align: center; color: #565f89;">Select a topic to start working with texts</p>
        </hgroup>

        <!-- === НОВИЙ БЛОК: ВИБІР МОДЕЛІ === -->
        <article class="model-selector-card">
            <label for="model-selector"><i class="fa-solid fa-robot"></i> Translation Model:</label>
            <select id="model-selector">
                <option value="gemini">Google Gemini 1.5 Flash</option>
                <option value="openrouter">OpenRouter (Grok Fast Free)</option>
            </select>
            <p id="save-confirmation">Your choice is saved!</p>
        </article>

        {% if categories %}
            <div class="category-grid">
                {% for category in categories %}
                    <a href="{{ url_for('show_projects_in_category', category_name=category) }}" class="category-card">
                        {% if 'Психологія' in category %}<i class="fa-solid fa-brain"></i>
                        {% elif 'Історія' in category %}<i class="fa-solid fa-landmark-dome"></i>
                        {% elif 'Релігія' in category %}<i class="fa-solid fa-place-of-worship"></i>
                        {% else %}<i class="fa-solid fa-file-alt"></i>
                        {% endif %}
                        <h2>{{ category }}</h2>
                    </a>
                {% endfor %}
            </div>
        {% else %}
            <article style="text-align: center;"><p>No categories found.</p></article>
        {% endif %}
    </main>

    <!-- === JAVASCRIPT ДЛЯ ЗБЕРЕЖЕННЯ ВИБОРУ МОДЕЛІ === -->
    <script>
        const modelSelector = document.getElementById('model-selector');
        const confirmationMessage = document.getElementById('save-confirmation');

        // 1. При завантаженні сторінки, встановлюємо значення селектора зі збереженого
        const savedModel = localStorage.getItem('selectedModel') || 'gemini'; // Gemini за замовчуванням
        modelSelector.value = savedModel;

        // 2. При зміні вибору, зберігаємо нове значення в localStorage
        modelSelector.addEventListener('change', () => {
            const selectedModel = modelSelector.value;
            localStorage.setItem('selectedModel', selectedModel);

            // Показуємо повідомлення про збереження
            confirmationMessage.style.opacity = '1';
            setTimeout(() => {
                confirmationMessage.style.opacity = '0';
            }, 2000);
        });
    </script>
</body>
</html>